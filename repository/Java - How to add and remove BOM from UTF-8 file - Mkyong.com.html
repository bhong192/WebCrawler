<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="VsVvSTVAouAluNodWeR30BeIWTr4c84HvN4Fn9WBsak"> <!-- wp_head --> <!-- This site is optimized with the Yoast SEO plugin v15.5 - https://yoast.com/wordpress/plugins/seo/ -->
  <title>Java - How to add and remove BOM from UTF-8 file - Mkyong.com</title>
  <meta name="description" content="This article shows you how to add and remove the byte order mark (BOM) from a UTF-8 file.">
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Java - How to add and remove BOM from UTF-8 file - Mkyong.com">
  <meta property="og:description" content="This article shows you how to add and remove the byte order mark (BOM) from a UTF-8 file.">
  <meta property="og:url" content="https://mkyong.com/java/java-how-to-add-and-remove-bom-from-utf-8-file/">
  <meta property="og:site_name" content="Mkyong.com">
  <meta property="article:published_time" content="2021-04-12T10:04:15+00:00">
  <meta property="article:modified_time" content="2021-04-14T07:01:05+00:00">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="mkyong">
  <meta name="twitter:label2" content="Est. reading time">
  <meta name="twitter:data2" content="5 minutes">  <!-- / Yoast SEO plugin. -->  
 </head>
 <body>
  <div class="container-fluid">
   <div class="row"> <!-- left -->
    <div id="sidebar-left" class="col-12 col-lg-3 col-xl-2"> <!-- sidebar-left-menu, see functions.php-->
     <div class="offcanvas offcanvas-start" tabindex="-1" id="left-nav" aria-labelledby="left-nav">
      <div class="offcanvas-header">
       <h5 class="offcanvas-title">Java IO Tutorial</h5>
      </div>
      <div class="offcanvas-body sidebar-left-no-highlight">
       <div>
        <ul>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
        </ul>
       </div>
      </div>
     </div> <!-- ads -->
     <div class="ads-container-sticky d-none d-lg-block">
      <div class="ads-container">
       <div align="center" data-freestar-ad="__160x600" id="mkyong_rail_left">  
       </div>
      </div>
     </div>
    </div> <!-- middle -->
    <main id="main-middle" role="main" class="col-12 col-lg-9 col-xl-7">
     <article id="main-content" class="dont-break-out">
      <div id="title-container">
       <h1>Java – How to add and remove BOM from UTF-8 file</h1>
       <div class="post-meta d-flex align-items-center position-relative">
        <div></div>
        <div>
         <p><small class="extra-info">By  | <time datetime="2021-04-14T15:01:05+08:00"> Last updated: April 14, 2021</time></small></p>
         <p><small class="extra-info">Viewed: 7,594 (+333 pv/w)</small></p>
         <p><small class="extra-info"></small></p>
         <div class="post-tag">
          <small class="extra-info">Tags: |  |  |  |  |  |  |  | </small>
         </div>
         <p></p>
        </div>
       </div>
      </div>
      <p>This article shows you how to add, check and remove the byte order mark (BOM) from a UTF-8 file. The  is the byte sequence <code>0xEF</code>, <code>0xBB</code>, <code>0xBF</code> (hexadecimal), at the beginning of the file.</p>
      <ul class="list-toc">
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
      </ul>
      <div class="note">
       <p><strong>Further Reading</strong><br> Read more about </p>
      </div>
      <p><em>P.S The below BOM examples only works for UTF-8 file.</em></p>
      <h2 id="add-bom-to-a-utf-8-file"> 1. Add BOM to a UTF-8 file<br></h2>
      <p>To Add BOM to a UTF-8 file, we can directly write Unicode <code>\ufeff</code> or three bytes <code>0xEF</code>,<code>0xBB</code>,<code>0xBF</code> at the beginning of the UTF-8 file.</p>
      <div class="note">
       <p><strong>Note</strong><br> The Unicode <code>\ufeff</code> represents <code>0xEF</code>,<code>0xBB</code>,<code>0xBF</code>, read .</p>
      </div>
      <p>1.1 The below example, write a BOM to a UTF-8 file <code>/home/mkyong/file.txt</code>.</p>
      <div class="filename">
       AddBomToUtf8File.java
      </div>
      <pre><code class="language-java">
package com.mkyong.io.howto;

import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class AddBomToUtf8File {

  public static void main(String[] args) throws IOException {

      Path path = Paths.get("/home/mkyong/file.txt");
      writeBomFile(path, "mkyong");

  }

  private static void writeBomFile(Path path, String content) {
        // Java 8 default UTF-8
        try (BufferedWriter bw = Files.newBufferedWriter(path)) {
            bw.write("\ufeff");
            bw.write(content);
            bw.newLine();
            bw.write(content);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

}
</code></pre>
      <p>Output</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ hexdump -C /home/mkyong/file.txt
00000000  ef bb bf 6d 6b 79 6f 6e  67 0a 6d 6b 79 6f 6e 67  |...mkyong.mkyong|
00000010

$ file /home/mkyong/file.txt
file.txt: UTF-8 Unicode (with BOM) text

$ cat /home/mkyong/file.txt
mkyong
mkyong
</code></pre>
      <p>1.2 Before Java 8, <code>BufferedWriter</code> and <code>OutputStreamWriter</code> examples of writing BOM to a UTF-8 file.</p>
      <pre><code class="language-java">
  private static void writeBomFile(Path path, String content) {
      try (BufferedWriter bw = new BufferedWriter(
              new OutputStreamWriter(
                      new FileOutputStream(path.toFile())
                      , StandardCharsets.UTF_8))) {
          bw.write("\ufeff");
          bw.write(content);
          bw.newLine();
          bw.write(content);
      } catch (IOException e) {
          e.printStackTrace();
      }
  }
</code></pre>
      <p>1.3 <code>PrintWriter</code> and <code>OutputStreamWriter</code> example to write BOM to a UTF-8 file. The <code>0xfeff</code> is the byte order mark (BOM) codepoint.</p>
      <pre><code class="language-java">
  private static void writeBomFile(Path path, String content) {
      try (PrintWriter pw = new PrintWriter(
              new OutputStreamWriter(
                      new FileOutputStream(path.toFile()), StandardCharsets.UTF_8))) {
          //pw.write("\ufeff");
          pw.write(0xfeff); // alternative, codepoint
          pw.write(content);
          pw.write(System.lineSeparator());
          pw.write(content);

      } catch (IOException e) {
          e.printStackTrace();
      }
  }
</code></pre>
      <p>1.4 Alternatively, we can write the BOM byte sequence <code>0xEF</code>, <code>0xBB</code>, and <code>0xBF</code> directly to a file.</p>
      <pre><code class="language-java">
  private static void writeBomFile4(Path path, String content) {
      try (FileOutputStream fos = new FileOutputStream(path.toFile())) {

          byte[] BOM = {(byte) 0xEF, (byte) 0xBB, (byte) 0xBF};

          fos.write(BOM);
          fos.write(content.getBytes(StandardCharsets.UTF_8));
          fos.write(System.lineSeparator().getBytes(StandardCharsets.UTF_8));
          fos.write(content.getBytes(StandardCharsets.UTF_8));

      } catch (IOException e) {
          e.printStackTrace();
      }
  }

</code></pre>
      <div class="ads-container ads-container-video">
       <div id="mkyongFreeStarVideoAdContainer">
        <div id="freestar-video-parent">
         <div id="freestar-video-child"></div>
        </div>
       </div>
      </div>
      <h2 id="check-if-a-file-contains-utf-8-bom"> 2. Check if a file contains UTF-8 BOM<br></h2>
      <p>The below example read the first 3 bytes from a file and check if it contains the <code>0xEF</code>, <code>0xBB</code>, <code>0xBF</code> byte sequence.</p>
      <div class="filename">
       CheckBom.java
      </div>
      <pre><code class="language-java">
package com.mkyong.io.howto;

import org.apache.commons.codec.binary.Hex;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class CheckBom {

  public static void main(String[] args) throws IOException {

      Path path = Paths.get("/home/mkyong/file.txt");

      if(isContainBOM(path)){
          System.out.println("Found BOM!");
      }else{
          System.out.println("No BOM.");
      }

  }

  private static boolean isContainBOM(Path path) throws IOException {

      if(Files.notExists(path)){
          throw new IllegalArgumentException("Path: " + path + " does not exists!");
      }

      boolean result = false;

      byte[] bom = new byte[3];
      try(InputStream is = new FileInputStream(path.toFile())){

          // read first 3 bytes of a file.
          is.read(bom);

          // BOM encoded as ef bb bf
          String content = new String(Hex.encodeHex(bom));
          if ("efbbbf".equalsIgnoreCase(content)) {
              result = true;
          }

      }

      return result;
  }

}
</code></pre>
      <p>Output</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
Found BOM!
</code></pre>
      <p>The <code>import org.apache.commons.codec.binary.Hex;</code> is in the below <code>commons-codec</code> library. Or, we can use .</p>
      <div class="filename">
       pom.xml
      </div>
      <pre><code class="language-xml">
  &lt;dependency&gt;
      &lt;groupId&gt;commons-codec&lt;/groupId&gt;
      &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;
      &lt;version&gt;1.14&lt;/version&gt;
  &lt;/dependency&gt;
</code></pre>
      <h2 id="remove-bom-from-a-utf-8-file"> 3. Remove BOM from a UTF-8 file<br></h2>
      <p>The below example <code>ByteBuffer</code> to remove BOM from a UTF-8 file.</p>
      <p><em>P.S Some XML, JSON, CSV parsers may fail to parse or process the file if it contains BOM in the UTF-8 file; it is common to remove or skip the BOM before parsing the file.</em></p>
      <div class="filename">
       RemoveBomFromUtf8File.java
      </div>
      <pre><code class="language-java">
package com.mkyong.io.howto;

import org.apache.commons.codec.binary.Hex;

import java.io.BufferedWriter;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.nio.ByteBuffer;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class RemoveBomFromUtf8File {

  public static void main(String[] args) throws IOException {

      Path path = Paths.get("/home/mkyong/file.txt");
      writeBomFile(path, "mkyong");
      removeBom(path);

  }

  private static void writeBomFile(Path path, String content) {
      // Java 8 default UTF-8
      try (BufferedWriter bw = Files.newBufferedWriter(path)) {
          bw.write("\ufeff");
          bw.write(content);
          bw.newLine();
          bw.write(content);
      } catch (IOException e) {
          e.printStackTrace();
      }
  }

  private static boolean isContainBOM(Path path) throws IOException {

      if (Files.notExists(path)) {
          throw new IllegalArgumentException("Path: " + path + " does not exists!");
      }

      boolean result = false;

      byte[] bom = new byte[3];
      try (InputStream is = new FileInputStream(path.toFile())) {

          // read 3 bytes of a file.
          is.read(bom);

          // BOM encoded as ef bb bf
          String content = new String(Hex.encodeHex(bom));
          if ("efbbbf".equalsIgnoreCase(content)) {
              result = true;
          }

      }

      return result;
  }

  private static void removeBom(Path path) throws IOException {

      if (isContainBOM(path)) {

          byte[] bytes = Files.readAllBytes(path);

          ByteBuffer bb = ByteBuffer.wrap(bytes);

          System.out.println("Found BOM!");

          byte[] bom = new byte[3];
          // get the first 3 bytes
          bb.get(bom, 0, bom.length);

          // remaining
          byte[] contentAfterFirst3Bytes = new byte[bytes.length - 3];
          bb.get(contentAfterFirst3Bytes, 0, contentAfterFirst3Bytes.length);

          System.out.println("Remove the first 3 bytes, and overwrite the file!");

          // override the same path
          Files.write(path, contentAfterFirst3Bytes);

      } else {
          System.out.println("This file doesn't contains UTF-8 BOM!");
      }

  }

}
</code></pre>
      <p>Output</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
Found BOM!
Remove the first 3 bytes, and overwrite the file!
</code></pre>
      <h2 id="copy-a-file-and-add-bom"> 4. Copy a file and add BOM<br></h2>
      <p>The below example copy of a file and add a BOM to the target file.</p>
      <div class="filename">
       CopyAndAddBomToXmlFile.java
      </div>
      <pre><code class="language-java">
package com.mkyong.xml.sax;

import java.io.FileOutputStream;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class CopyAndAddBomToXmlFile {

    public static void main(String[] args) {
        Path src = Paths.get("src/main/resources/staff.xml");
        Path dest = Paths.get("src/main/resources/staff-bom.xml");
        writeBomFile(src, dest);
    }

    private static void writeBomFile(Path src, Path dest) {

        try (FileOutputStream fos = new FileOutputStream(dest.toFile())) {

            byte[] BOM = {(byte) 0xEF, (byte) 0xBB, (byte) 0xBF};
            // add BOM
            fos.write(BOM);

            // BOM + src to fos
            Files.copy(src, fos);

        } catch (IOException e) {
            e.printStackTrace();
        }


    }

}
</code></pre>
      <h2 id="download-source-code"> 5. Download Source Code<br></h2>
      <div class="github">
       <p>$ git clone </p>
       <p>$ cd java-io</p>
      </div>
      <h2 id="references"> 6. References<br></h2>
      <ul>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
      </ul> <!-- current post ID --> 
      <div class="d-flex justify-content-center ads-container-after-post ads-container"> <!-- Tag ID: mkyong_leaderboard_btf -->
       <div align="center" data-freestar-ad="__320x100 __336x280" id="mkyong_leaderboard_btf">  
       </div>
      </div> <!-- loaded via JS -->
      <div id="mk-afterpost-related"></div> <!-- author -->
      <div id="author-container" class="d-flex align-items-center position-relative">
       <div></div>
       <div>
        <h5></h5>
        <p>Founder of , love Java and open source stuff. Follow him on . If you like my tutorials, consider make a donation to .</p>
        <p></p>
       </div>
      </div> <!-- comments -->
      <h4>Comments</h4>
      <div class="wpdiscuz_top_clearing"></div>
      <div id="comments" class="comments-area">
       <div id="respond" style="width: 0;height: 0;clear: both;margin: 0;padding: 0;"></div>
       <div id="wpdcom" class="wpdiscuz_unauth wpd-default wpd-layout-1 wpd-comments-open">
        <div class="wc_social_plugin_wrapper"></div>
        <div class="wpd-form-wrap">
         <div class="wpd-form-head">
          <div class="wpd-auth">
           <div class="wpd-login"></div>
          </div>
         </div>
         <div class="wpd-form wpd-form-wrapper wpd-main-form-wrapper" id="wpd-main-form-wrapper-0_0"></div>
         <div id="wpdiscuz_hidden_secondary_form" style="display: none;">
          <div class="wpd-form wpd-form-wrapper wpd-secondary-form-wrapper" id="wpd-secondary-form-wrapper-wpdiscuzuniqueid" style="display: none;">
           <div class="wpd-secondary-forms-social-content"></div>
           <div class="clearfix"></div>
          </div>
         </div>
        </div>
        <div id="wpd-threads" class="wpd-thread-wrapper">
         <div class="wpd-thread-head">
          <div class="wpd-thread-info " data-comments-count="1"> <span class="wpdtc" title="1">1</span> Comment
          </div>
          <div class="wpd-space"></div>
          <div class="wpd-thread-filter">
           <div class="wpd-filter wpdf-sorting"> <span class="wpdiscuz-sort-button wpdiscuz-vote-sort-up wpdiscuz-sort-button-active" data-sorting="by_vote">Most Voted</span> <i class="fas fa-sort-down"></i>
            <div class="wpdiscuz-sort-buttons"> <span class="wpdiscuz-sort-button wpdiscuz-date-sort-desc" data-sorting="newest">Newest</span> <span class="wpdiscuz-sort-button wpdiscuz-date-sort-asc" data-sorting="oldest">Oldest</span>
            </div>
           </div>
          </div>
         </div>
         <div class="wpd-comment-info-bar">
          <div class="wpd-current-view">
           <i class="fas fa-quote-left"></i> Inline Feedbacks
          </div>
          <div class="wpd-filter-view-all">
           View all comments
          </div>
         </div>
         <div class="wpd-thread-list">
          <div id="wpd-comm-1061797_0" class="wpd-comment wpd_comment_level-1">
           <div class="wpd-comment-wrap wpd-blog-guest">
            <div class="wpd-comment-left ">
             <div class="wpd-avatar "> 
             </div>
            </div>
            <div id="comment-1061797" class="wpd-comment-right">
             <div class="wpd-comment-header">
              <div class="wpd-comment-author ">
                Stanislav Tanev
              </div>
              <div class="wpd-comment-date" title="September 1, 2021 5:58 pm"> <i class="far fa-clock" aria-hidden="true"></i> 27 days ago
              </div>
              <div class="wpd-space"></div>
              <div class="wpd-comment-link wpd-hidden">
               <div style="" class="comment_flag comment_flag_modal wc_flag_tooltipster wpf-cta wpd-field-desc" wpd-tooltip-position="left" id="fc_1061797" wpd-tooltip="Click to flag and open «Comment Reporting» form. You can choose reporting category and send message to website administrator. Admins may or may not choose to remove the comment or block the author. And please don" t worry, your report will be anonymous.'>
                <i class="fas fa-flag"></i>
               </div>
              </div>
             </div>
             <div class="wpd-comment-text">
              <p>Great Article ! Really appreciate the information !</p>
             </div>
             <div class="wpd-comment-footer">
              <div class="wpd-vote">
               <div class="wpd-vote-up wpd_not_clicked"> 
                <svg xmlns="https://www.w3.org/2000/svg" viewbox="0 0 24 24">
                 <path fill="none" d="M0 0h24v24H0V0z" /><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" />
                </svg>
               </div>
               <div class="wpd-vote-result" title="0">
                0
               </div>
               <div class="wpd-vote-down wpd_not_clicked"> 
                <svg xmlns="https://www.w3.org/2000/svg" viewbox="0 0 24 24">
                 <path fill="none" d="M0 0h24v24H0z" /><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z" />
                </svg>
               </div>
              </div>
              <div class="wpd-reply-button"> 
               <svg xmlns="https://www.w3.org/2000/svg" viewbox="0 0 24 24">
                <path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z" /><path d="M0 0h24v24H0z" fill="none" />
               </svg> <span>Reply</span>
              </div>
              <div class="wpd-space"></div>
             </div>
            </div>
           </div>
           <div id="wpdiscuz_form_anchor-1061797_0"></div>
          </div>
          <div class="wpdiscuz-comment-pagination"></div>
         </div>
        </div>
       </div>
      </div>
      <div id="wpdiscuz-loading-bar" class="wpdiscuz-loading-bar-unauth"></div>
      <div id="wpdiscuz-comment-message" class="wpdiscuz-comment-message-unauth"></div>
     </article>
    </main> <!-- right -->
    <div id="sidebar-right" class="d-none d-xl-block col-xl-3">
     <div class="ads-container-height1080">
      <div class="ads-container-sticky">
       <div class="ads-container">
        <div align="center" data-freestar-ad="__300x600" id="mkyong_rail_right_1">  
        </div>
       </div>
      </div>
     </div>
     <div class="ads-container-sticky">
      <div class="ads-container">
       <div align="center" data-freestar-ad="__300x600" id="mkyong_rail_right_2">  
       </div>
      </div>
     </div>
    </div>
   </div> <!--/.row -->
  </div> <!--/.container-fluid -->  <!-- Dynamic page generated in 0.093 seconds. --><!-- Cached page generated by WP-Super-Cache on 2021-09-29 17:40:07 --><!-- super cache -->
 </body>
</html>