<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="VsVvSTVAouAluNodWeR30BeIWTr4c84HvN4Fn9WBsak"> <!-- wp_head --> <!-- This site is optimized with the Yoast SEO plugin v15.5 - https://yoast.com/wordpress/plugins/seo/ -->
  <title>Jersey and JSON examples (EclipseLink MOXy) - Mkyong.com</title>
  <meta name="description" content="JSON response in Jersey (Using MOXy), custom Moxy config, custom exception mapper, unit test the Jersey JSON response endpoints, etc.">
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Jersey and JSON examples (EclipseLink MOXy) - Mkyong.com">
  <meta property="og:description" content="JSON response in Jersey (Using MOXy), custom Moxy config, custom exception mapper, unit test the Jersey JSON response endpoints, etc.">
  <meta property="og:url" content="https://mkyong.com/webservices/jax-rs/jersey-and-json-examples-eclipselink-moxy/">
  <meta property="og:site_name" content="Mkyong.com">
  <meta property="article:published_time" content="2021-06-23T13:58:42+00:00">
  <meta property="article:modified_time" content="2021-06-26T07:32:15+00:00">
  <meta property="og:image" content="https://mkyong.com/wp-content/uploads/2021/06/jersey-json-moxy-logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="mkyong">
  <meta name="twitter:label2" content="Est. reading time">
  <meta name="twitter:data2" content="12 minutes">  <!-- / Yoast SEO plugin. -->  
 </head>
 <body>
  <div class="container-fluid">
   <div class="row"> <!-- left -->
    <div id="sidebar-left" class="col-12 col-lg-3 col-xl-2"> <!-- sidebar-left-menu, see functions.php-->
     <div class="offcanvas offcanvas-start" tabindex="-1" id="left-nav" aria-labelledby="left-nav">
      <div class="offcanvas-header">
       <h5 class="offcanvas-title">Main Tutorials</h5>
      </div>
      <div class="offcanvas-body sidebar-left-no-highlight">
       <div>
        <ul>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
        </ul>
       </div>
      </div>
     </div> <!-- ads -->
     <div class="ads-container-sticky d-none d-lg-block">
      <div class="ads-container">
       <div align="center" data-freestar-ad="__160x600" id="mkyong_rail_left">  
       </div>
      </div>
     </div>
    </div> <!-- middle -->
    <main id="main-middle" role="main" class="col-12 col-lg-9 col-xl-7">
     <article id="main-content" class="dont-break-out">
      <div id="title-container">
       <h1>Jersey and JSON examples (EclipseLink MOXy)</h1>
       <div class="post-meta d-flex align-items-center position-relative">
        <div></div>
        <div>
         <p><small class="extra-info">By  | <time datetime="2021-06-26T15:32:15+08:00"> Last updated: June 26, 2021</time></small></p>
         <p><small class="extra-info">Viewed: 2,799 (+187 pv/w)</small></p>
         <p><small class="extra-info"></small></p>
         <div class="post-tag">
          <small class="extra-info">Tags: |  |  |  |  |  |  |  | </small>
         </div>
         <p></p>
        </div>
       </div>
      </div>
      <p></p>
      <div class="pic"> 
      </div>
      <p></p>
      <p>This article shows how to return a  response in the , using .</p>
      <p>Tested with</p>
      <ul>
       <li>Jersey 3.0.2</li>
       <li>EclipseLink MOXy 3</li>
       <li>Jetty 11, HTTP Server</li>
       <li>Java 11</li>
       <li>Maven 3</li>
       <li>SLF4J, Logback, redirect Jersey J.U.L logs to logback</li>
       <li>JUnit 5 and JSONassert 1.5 (Unit Test)</li>
       <li>org.json 20210307, JSONObject</li>
      </ul>
      <p>Table of contents</p>
      <ul class="list-toc">
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li>
        <ul>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
         <li></li>
        </ul></li>
       <li></li>
       <li></li>
       <li></li>
      </ul>
      <h2 id="eclipselink-moxy-as-the-json-provider-in-jersey"> 1. EclipseLink MOXy as the JSON provider in Jersey<br></h2>
      <p>We can include  to make EclipseLink MOXy the JSON provider in the Jersey application.</p>
      <div class="filename">
       pom.xml
      </div>
      <pre><code class="language-xml">
  &lt;!-- add EclipseLink MOXy as json provider --&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
      &lt;artifactId&gt;jersey-media-moxy&lt;/artifactId&gt;
  &lt;/dependency&gt;
</code></pre>
      <div class="ads-container ads-container-video">
       <div id="mkyongFreeStarVideoAdContainer">
        <div id="freestar-video-parent">
         <div id="freestar-video-child"></div>
        </div>
       </div>
      </div>
      <h2 id="project-directory"> 2. Project directory<br></h2>
      <p>Review the Maven standard project directory.</p>
      <div class="pic"> 
      </div>
      <p></p>
      <h2 id="project-dependencies"> 3. Project dependencies<br></h2>
      <p>Review the project dependencies.</p>
      <div class="filename">
       pom.xml
      </div>
      <pre><code class="language-xml">
  &lt;properties&gt;
      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
      &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
      &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
      &lt;java.version&gt;11&lt;/java.version&gt;
      &lt;junit.version&gt;5.4.0&lt;/junit.version&gt;
      &lt;jsonassert.version&gt;1.5.0&lt;/jsonassert.version&gt;
      &lt;jersey.version&gt;3.0.2&lt;/jersey.version&gt;
      &lt;logback.version&gt;1.2.3&lt;/logback.version&gt;
      &lt;slf4j.version&gt;1.7.31&lt;/slf4j.version&gt;
      &lt;org.json.version&gt;20210307&lt;/org.json.version&gt;
      &lt;servlet.api.version&gt;5.0.0&lt;/servlet.api.version&gt;
  &lt;/properties&gt;

  &lt;dependencyManagement&gt;
      &lt;dependencies&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;org.glassfish.jersey&lt;/groupId&gt;
              &lt;artifactId&gt;jersey-bom&lt;/artifactId&gt;
              &lt;version&gt;${jersey.version}&lt;/version&gt;
              &lt;type&gt;pom&lt;/type&gt;
              &lt;scope&gt;import&lt;/scope&gt;
          &lt;/dependency&gt;
      &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;

  &lt;dependencies&gt;

      &lt;!-- Jetty HTTP Server --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
          &lt;artifactId&gt;jersey-container-jetty-http&lt;/artifactId&gt;
      &lt;/dependency&gt;

      &lt;!-- Jetty 11 needs Servlet 5 --&gt;
      &lt;!-- java.lang.NoClassDefFoundError: jakarta/servlet/ServletInputStream --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;jakarta.servlet&lt;/groupId&gt;
          &lt;artifactId&gt;jakarta.servlet-api&lt;/artifactId&gt;
          &lt;version&gt;${servlet.api.version}&lt;/version&gt;
      &lt;/dependency&gt;

      &lt;!-- Jersey DI and core--&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;
          &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;
      &lt;/dependency&gt;

      &lt;!-- add MOXy as json provider --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
          &lt;artifactId&gt;jersey-media-moxy&lt;/artifactId&gt;
      &lt;/dependency&gt;

      &lt;!-- optional, only if you want the JSONObject --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.json&lt;/groupId&gt;
          &lt;artifactId&gt;json&lt;/artifactId&gt;
          &lt;version&gt;${org.json.version}&lt;/version&gt;
      &lt;/dependency&gt;

      &lt;!-- logging, bridge jul to slf4j --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
          &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt;
          &lt;version&gt;${slf4j.version}&lt;/version&gt;
      &lt;/dependency&gt;

      &lt;!-- slf4j implementation --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
          &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
          &lt;version&gt;${logback.version}&lt;/version&gt;
      &lt;/dependency&gt;

      &lt;!-- JUnit 5 --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
          &lt;artifactId&gt;junit-jupiter-params&lt;/artifactId&gt;
          &lt;version&gt;${junit.version}&lt;/version&gt;
          &lt;scope&gt;test&lt;/scope&gt;
      &lt;/dependency&gt;

      &lt;!-- test json data --&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.skyscreamer&lt;/groupId&gt;
          &lt;artifactId&gt;jsonassert&lt;/artifactId&gt;
          &lt;version&gt;${jsonassert.version}&lt;/version&gt;
          &lt;scope&gt;test&lt;/scope&gt;
      &lt;/dependency&gt;

  &lt;/dependencies&gt;
</code></pre>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
mvn dependency:tree

[INFO] Scanning for projects...
[INFO]
[INFO] -------------------&lt; com.mkyong:jersey-json-example &gt;-------------------
[INFO] Building jersey-json-example 1.0
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- maven-dependency-plugin:3.1.2:tree (default-cli) @ jersey-json-example ---
[INFO] com.mkyong:jersey-json-example:jar:1.0
[INFO] +- org.glassfish.jersey.containers:jersey-container-jetty-http:jar:3.0.2:compile
[INFO] |  +- jakarta.inject:jakarta.inject-api:jar:2.0.0:compile
[INFO] |  +- org.eclipse.jetty:jetty-server:jar:11.0.0:compile
[INFO] |  |  +- org.eclipse.jetty:jetty-http:jar:11.0.0:compile
[INFO] |  |  \- org.eclipse.jetty:jetty-io:jar:11.0.0:compile
[INFO] |  +- org.eclipse.jetty:jetty-util:jar:11.0.0:compile
[INFO] |  +- org.glassfish.jersey.core:jersey-common:jar:3.0.2:compile
[INFO] |  |  +- jakarta.annotation:jakarta.annotation-api:jar:2.0.0:compile
[INFO] |  |  \- org.glassfish.hk2:osgi-resource-locator:jar:1.0.3:compile
[INFO] |  +- org.glassfish.jersey.core:jersey-server:jar:3.0.2:compile
[INFO] |  |  +- org.glassfish.jersey.core:jersey-client:jar:3.0.2:compile
[INFO] |  |  \- jakarta.validation:jakarta.validation-api:jar:3.0.0:compile
[INFO] |  \- jakarta.ws.rs:jakarta.ws.rs-api:jar:3.0.0:compile
[INFO] +- jakarta.servlet:jakarta.servlet-api:jar:5.0.0:compile
[INFO] +- org.glassfish.jersey.inject:jersey-hk2:jar:3.0.2:compile
[INFO] |  +- org.glassfish.hk2:hk2-locator:jar:3.0.1:compile
[INFO] |  |  +- org.glassfish.hk2.external:aopalliance-repackaged:jar:3.0.1:compile
[INFO] |  |  +- org.glassfish.hk2:hk2-api:jar:3.0.1:compile
[INFO] |  |  \- org.glassfish.hk2:hk2-utils:jar:3.0.1:compile
[INFO] |  \- org.javassist:javassist:jar:3.25.0-GA:compile
[INFO] +- org.glassfish.jersey.media:jersey-media-moxy:jar:3.0.2:compile
[INFO] |  +- org.glassfish.jersey.ext:jersey-entity-filtering:jar:3.0.2:compile
[INFO] |  +- jakarta.json:jakarta.json-api:jar:2.0.0:compile
[INFO] |  +- jakarta.json.bind:jakarta.json.bind-api:jar:2.0.0:compile
[INFO] |  +- org.glassfish:jakarta.json:jar:module:2.0.0:compile
[INFO] |  \- org.eclipse.persistence:org.eclipse.persistence.moxy:jar:3.0.0:compile
[INFO] |     +- jakarta.xml.bind:jakarta.xml.bind-api:jar:3.0.0:compile
[INFO] |     +- org.eclipse.persistence:org.eclipse.persistence.asm:jar:3.0.0:compile
[INFO] |     +- org.eclipse.persistence:org.eclipse.persistence.core:jar:3.0.0:compile
[INFO] |     +- com.sun.activation:jakarta.activation:jar:2.0.0:runtime
[INFO] |     \- com.sun.mail:jakarta.mail:jar:2.0.0:runtime
[INFO] +- org.json:json:jar:20210307:compile
[INFO] +- org.slf4j:jul-to-slf4j:jar:1.7.31:compile
[INFO] |  \- org.slf4j:slf4j-api:jar:1.7.31:compile
[INFO] +- ch.qos.logback:logback-classic:jar:1.2.3:compile
[INFO] |  \- ch.qos.logback:logback-core:jar:1.2.3:compile
[INFO] +- org.junit.jupiter:junit-jupiter-params:jar:5.4.0:test
[INFO] |  +- org.apiguardian:apiguardian-api:jar:1.0.0:test
[INFO] |  \- org.junit.jupiter:junit-jupiter-api:jar:5.4.0:test
[INFO] |     +- org.opentest4j:opentest4j:jar:1.1.1:test
[INFO] |     \- org.junit.platform:junit-platform-commons:jar:1.4.0:test
[INFO] \- org.skyscreamer:jsonassert:jar:1.5.0:test
[INFO]    \- com.vaadin.external.google:android-json:jar:0.0.20131108.vaadin1:test
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  7.664 s
[INFO] Finished at: 2021-06-23T16:00:25+08:00
[INFO] ------------------------------------------------------------------------
</code></pre>
      <h2 id="return-a-json-response-in-jersey"> 4. Return a JSON response in Jersey<br></h2>
      <p>A few JSON response endpoints in Jersey application, and MOXy will handle the object to/from JSON conversion.</p>
      <div class="filename">
       JsonResource.java
      </div>
      <pre><code class="language-java">
package com.mkyong.json;

import jakarta.ws.rs.Consumes;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.POST;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.PathParam;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;
import jakarta.ws.rs.core.Response;
import org.json.JSONObject;

import java.util.Arrays;
import java.util.List;

@Path("/json")
public class JsonResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Response hello() {

        // create a JSON string
        JSONObject json = new JSONObject();
        json.put("result", "Jersey JSON example using MOXy");

        // MUST json.toString(), else empty result or Unconsumed content
        // return Response.status(Response.Status.OK).entity(json).build();
        return Response.status(Response.Status.OK).entity(json.toString()).build();

    }

    // Object to JSON
    @Path("/{name}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public User hello(@PathParam("name") String name) {
        return new User(1, name);
    }

    // A list of objects to JSON
    @Path("/all")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public List&lt;User&gt; helloList() {
        return Arrays.asList(
                new User(1, "mkyong"),
                new User(2, "zilap")
        );
    }

    // POST, accepts JSON
    @Path("/create")
    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    public Response create(User user) {

        JSONObject json = new JSONObject();
        json.put("status", "ok");
        return Response.status(Response.Status.CREATED).entity(json.toString()).build();

    }

}
</code></pre>
      <p>Below is the <code>User</code> object.</p>
      <div class="filename">
       User.java
      </div>
      <pre><code class="language-java">
package com.mkyong.json;

// optional, for json response, no need @XmlRootElement
// only needed if works with XML
// @XmlRootElement
public class User {

    private int id;
    String name;

    // getters, setters and constructors and etc
}
</code></pre>
      <h2 id="start-jersey-application"> 5. Start Jersey application<br></h2>
      <p>Starts Jetty HTTP server and deploys the Jersey application at <code>http://localhost:8080</code>.</p>
      <p><em>P.S The static initialization is optional, and it is for the logging setup to redirect Jersey’s J.U.L logs to the SLF4J Logback implementation.</em></p>
      <div class="filename">
       MainApp.java
      </div>
      <pre><code class="language-java">
package com.mkyong;

import com.mkyong.json.JsonResource;
import org.eclipse.jetty.server.Server;
import org.glassfish.jersey.jetty.JettyHttpContainerFactory;
import org.glassfish.jersey.server.ResourceConfig;
import org.slf4j.bridge.SLF4JBridgeHandler;

import java.io.IOException;
import java.net.URI;
import java.util.logging.Level;
import java.util.logging.Logger;

public class MainApp {

    public static final URI BASE_URI = URI.create("http://localhost:8080");

    // For logging, setup to redirect J.U.L to logback
    static {
        // JUL Root logger to the lowest level, so that bridge can intercept all j.u.l. logs
        Logger.getLogger("").setLevel(Level.FINEST);

        // Optionally remove existing handlers attached to j.u.l root logger
        // (since SLF4J 1.6.5)
        SLF4JBridgeHandler.removeHandlersForRootLogger();

        // add SLF4JBridgeHandler to j.u.l's root logger, should be done once during
        // the initialization phase of your application
        SLF4JBridgeHandler.install();
    }

    // Starts Jetty HTTP server
    public static Server startHttpServer() {

        final ResourceConfig config = new ResourceConfig();

        // scan only one resource
        config.register(JsonResource.class);

        return JettyHttpContainerFactory.createServer(BASE_URI, config);

    }

    public static void main(String[] args) throws Exception {

        try {

            final Server server = startHttpServer();

            server.start();

            // shut down hook
            Runtime.getRuntime().addShutdownHook(
                    new Thread(() -&gt; {
                        try {
                            server.stop();
                        } catch (Exception e) {
                            Logger.getLogger(MainApp.class.getName()).log(Level.SEVERE, null, e);
                        }
                    })
            );

            System.out.println(String.format("Application started.%nStop the application using CTRL+C"));

            // block and wait shut down signal, like CTRL+C
            Thread.currentThread().join();

        } catch (InterruptedException | IOException ex) {
            Logger.getLogger(MainApp.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

}
</code></pre>
      <h2 id="demo"> 6. DEMO<br></h2>
      <p>Starts the <code>MainApp</code> and using the <code>cURL</code> tool to do simple testing.</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ curl http://localhost:8080/json
{"result":"Jersey JSON example using MOXy"}

$ curl http://localhost:8080/json/jersey
{"id":1,"name":"jersey"}

$ curl http://localhost:8080/json/all
[{"id":1,"name":"mkyong"},{"id":2,"name":"zilap"}]

$ curl -v -H "Content-Type: application/json" -X POST -d "{\"id\" : 1,\"name\" : \"mkyong\"}" http://localhost:8080/json/create

*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; POST /json/create HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.55.1
&gt; Accept: */*
&gt; Content-Type: application/json
&gt; Content-Length: 28
&gt;
* upload completely sent off: 28 out of 28 bytes
&lt; HTTP/1.1 201 Created
&lt; Date: Wed, 23 Jun 2021 06:48:53 GMT
&lt; Content-Type: application/json
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(11.0.0)
&lt;
{"status":"ok"}*
</code></pre>
      <h2 id="custom-moxy-config"> 7. Custom Moxy Config<br></h2>
      <p>7.1 In the above demo, the JSON response is in compact mode, the default behavior of MOXy; We can create a new<code>MoxyJsonConfig</code> to configure the MOXy, for example, enable the MOXy’s JSON response in a pretty print format.</p>
      <div class="filename">
       CustomMoxyConfig.java
      </div>
      <pre><code class="language-java">
package com.mkyong.json;

import jakarta.ws.rs.ext.ContextResolver;
import jakarta.ws.rs.ext.Provider;
import org.glassfish.jersey.moxy.json.MoxyJsonConfig;

@Provider
public class CustomMoxyConfig implements ContextResolver&lt;MoxyJsonConfig&gt; {

    final MoxyJsonConfig moxyJsonConfig;

    public CustomMoxyConfig() {
        moxyJsonConfig = new MoxyJsonConfig();

        // pretty print
        moxyJsonConfig.setFormattedOutput(true);
    }

    @Override
    public MoxyJsonConfig getContext(Class&lt;?&gt; type) {
        return moxyJsonConfig;
    }

}
</code></pre>
      <p>7.2 Register the custom <code>MoxyJsonConfig</code> in <code>ResourceConfig</code>.</p>
      <div class="filename">
       MainApp.java
      </div>
      <pre><code class="language-java">
  // Starts Jetty HTTP server
  public static Server startHttpServer() {

      final ResourceConfig config = new ResourceConfig();

      // scan only one resource
      config.register(JsonResource.class);

      // only register if contains custom moxy config
      config.register(CustomMoxyConfig.class);

      return JettyHttpContainerFactory.createServer(BASE_URI, config);

  }
</code></pre>
      <p>7.3 Restart the <code>MainApp</code> again, and now the JSON response is in a pretty print format.</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ curl http://localhost:8080/json/all
[ {
   "id" : 1,
   "name" : "mkyong"
}, {
   "id" : 2,
   "name" : "zilap"
} ]
</code></pre>
      <h2 id="exceptionmapper-custom-404-json-response-in-jersey"> 8. ExceptionMapper – Custom 404 JSON response in Jersey<br></h2>
      <p>Later, we will create a custom <code>ExceptionMapper</code> to intercept the default 404 error exception and return our custom JSON response.</p>
      <h3 id="jersey-404-not-found"> 8.1 Jersey 404 Not Found<br></h3>
      <p>Try access to some non-exists URL, and Jersey will return status 404 and empty response.</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ curl http://localhost:8080/json/all/error  
</code></pre>
      <p>We can use <code>curl -v</code> to display the request and response detail, for example, the response status code.</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ curl -v http://localhost:8080/json/all/error

*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /json/all/error HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.55.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 404 Not Found
&lt; Date: Wed, 23 Jun 2021 07:18:01 GMT
&lt; Content-Length: 0
&lt; Server: Jetty(11.0.0)
&lt;
</code></pre>
      <h3 id="exceptionmapper-and-notfoundexception"> 8.2 ExceptionMapper and NotFoundException<br></h3>
      <p>Create a custom exception mapper of <code>NotFoundException</code> to intercept the 404 error.</p>
      <div class="filename">
       CustomExceptionMapper.java
      </div>
      <pre><code class="language-java">
package com.mkyong.json;

import jakarta.ws.rs.NotFoundException;
import jakarta.ws.rs.core.Response;
import jakarta.ws.rs.ext.ExceptionMapper;
import jakarta.ws.rs.ext.Provider;
import org.json.JSONObject;

@Provider
public class CustomNotFoundExceptionMapper
        implements ExceptionMapper&lt;NotFoundException&gt; {

    @Override
    public Response toResponse(NotFoundException exception) {

        JSONObject json = new JSONObject();
        json.put("error", "url not found!");
        return Response.status(Response.Status.NOT_FOUND)
                .entity(json.toString())
                .build();
    }

}
</code></pre>
      <h3 id="register-custom-exceptionmapper-in-resourceconfig"> 8.3 Register custom ExceptionMapper in ResourceConfig<br></h3>
      <div class="filename">
       MainApp.java
      </div>
      <pre><code class="language-java">
  // Starts Jetty HTTP server
  public static Server startHttpServer() {

      final ResourceConfig config = new ResourceConfig();

      // scan only one resource
      config.register(JsonResource.class);

      // only register if contains custom moxy config
      config.register(CustomMoxyConfig.class);

      // only register if contains custom exception mapper
      config.register(CustomNotFoundExceptionMapper.class);

      return JettyHttpContainerFactory.createServer(BASE_URI, config);

  }
</code></pre>
      <h3 id="demo-with-customnotfoundexceptionmapper"> 8.3 DEMO with CustomNotFoundExceptionMapper<br></h3>
      <p>Restart the Jersey application and access some non exists URL again. Now, Jersey will return our custom JSON response.</p>
      <div class="filename">
       Terminal
      </div>
      <pre><code class="language-bash">
$ curl http://localhost:8080/json/all/error
{"error":"url not found!"}

$ curl -v http://localhost:8080/json/all/error
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /json/all/error HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.55.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 404 Not Found
&lt; Date: Wed, 23 Jun 2021 07:38:23 GMT
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(11.0.0)
&lt;
{"error":"url not found!"}
</code></pre>
      <h3 id="webapplicationexception"> 8.4 WebApplicationException<br></h3>
      <p>Suppose we are unsure of the exact type of <code>Exception</code> to intercept, and we try to intercept the JAX-RS <code>WebApplicationException</code>. In that case, it should match all errors thrown by the Jersey application.</p>
      <p>In IDE, we can put a breakpoint inside <code>toResponse</code> and observe the Jersey application type of exception throws.</p>
      <div class="filename">
       CustomExceptionMapper.java
      </div>
      <pre><code class="language-java">
package com.mkyong.json;

import jakarta.ws.rs.WebApplicationException;
import jakarta.ws.rs.core.Response;
import jakarta.ws.rs.ext.ExceptionMapper;
import jakarta.ws.rs.ext.Provider;
import org.json.JSONObject;

@Provider
public class CustomExceptionMapper
      implements ExceptionMapper&lt;WebApplicationException&gt; {

  @Override
  public Response toResponse(WebApplicationException exception) {

      JSONObject json = new JSONObject();
      json.put("error", exception.getMessage());
      //json.put("error", "some error");

      // 400
      return Response.status(Response.Status.BAD_REQUEST)
              .entity(json.toString())
              .build();
  }

}
</code></pre>
      <p>Still unable to catch the exception? try <code>implements ExceptionMapper&lt;Exception&gt;</code>.</p>
      <h2 id="unit-test-a-jersey-json-endpoints"> 9. Unit test a Jersey JSON endpoints<br></h2>
      <p>Below are some tests for the above Jersey endpoints.</p>
      <div class="filename">
       JsonResourceTest.java
      </div>
      <pre><code class="language-java">
package com.mkyong;

import jakarta.ws.rs.client.Client;
import jakarta.ws.rs.client.ClientBuilder;
import jakarta.ws.rs.client.Entity;
import jakarta.ws.rs.client.WebTarget;
import jakarta.ws.rs.core.MediaType;
import jakarta.ws.rs.core.Response;
import org.eclipse.jetty.server.Server;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;
import org.skyscreamer.jsonassert.JSONAssert;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class JsonResourceTest {

  private static Server server;
  private static WebTarget target;

  @BeforeAll
  public static void beforeAllTests() {
      server = MainApp.startHttpServer();
      Client c = ClientBuilder.newClient();
      target = c.target(MainApp.BASE_URI.toString());
  }

  @AfterAll
  public static void afterAllTests() throws Exception {
      server.stop();
  }

  @Test
  public void testJson() throws JSONException {

      String actual = target.path("json").request().get(String.class);
      String expected = "{\"result\":\"Jersey JSON example using MOXy\"}";

      JSONAssert.assertEquals(expected, actual, false);

  }

  @Test
  public void testJsonName() throws JSONException {

      String response = target.path("json/mkyong")
              .request(MediaType.APPLICATION_JSON)
              .get(String.class);

      // convert json string to JSONObject
      JSONObject actual = new JSONObject(response);

      String expected = "{\"id\":1,\"name\":\"mkyong\"}";
      JSONAssert.assertEquals(expected, actual, false);

  }

  @Test
  public void testJsonAll() throws JSONException {

      String response = target.path("json/all")
              .request(MediaType.APPLICATION_JSON)
              .get(String.class);

      // convert json string to JSONArray
      JSONArray actual = new JSONArray(response);

      String expected = "[{\"id\":1,\"name\":\"mkyong\"},{\"id\":2,\"name\":\"zilap\"}]";
      JSONAssert.assertEquals(expected, actual, false);

  }

  @Test
  public void testJsonCreateOk() throws JSONException {

      String json = "{\"id\":1,\"name\":\"mkyong\"}";

      Response response = target.path("json/create")
              .request(MediaType.APPLICATION_JSON)
              .post(Entity.entity(json, MediaType.valueOf("application/json")));

      assertEquals(Response.Status.CREATED.getStatusCode(), response.getStatus());

      // read response body
      String actual = response.readEntity(String.class);
      String expected = "{\"status\":\"ok\"}";
      JSONAssert.assertEquals(expected, actual, false);

  }

  @Test
  public void testJsonCustomNotFound() throws JSONException {

      Response response = target.path("json/all/error")
              .request(MediaType.APPLICATION_JSON).buildGet().invoke();

      // ensure 404 status code
      assertEquals(Response.Status.NOT_FOUND.getStatusCode(), response.getStatus());

      // test json response
      String actual = response.readEntity(String.class);
      String expected = "{\"error\":\"url not found!\"}";
      JSONAssert.assertEquals(expected, actual, false);

  }

}
</code></pre>
      <div class="note">
       <p><strong>Alternative, try Jackson</strong><br> </p>
      </div>
      <h2 id="download-source-code"> 10. Download Source Code<br></h2>
      <div class="github">
       <p>$ git clone </p>
       <p>$ cd jax-rs/jersey/jersey-json-moxy/</p>
       <p>$ mvn package</p>
       <p>$ java -jar target/jersey-json-moxy.jar</p>
      </div>
      <h2 id="references"> 11. References<br></h2>
      <ul>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
       <li></li>
      </ul> <!-- current post ID --> 
      <div class="d-flex justify-content-center ads-container-after-post ads-container"> <!-- Tag ID: mkyong_leaderboard_btf -->
       <div align="center" data-freestar-ad="__320x100 __336x280" id="mkyong_leaderboard_btf">  
       </div>
      </div> <!-- loaded via JS -->
      <div id="mk-afterpost-related"></div> <!-- author -->
      <div id="author-container" class="d-flex align-items-center position-relative">
       <div></div>
       <div>
        <h5></h5>
        <p>Founder of , love Java and open source stuff. Follow him on . If you like my tutorials, consider make a donation to .</p>
        <p></p>
       </div>
      </div> <!-- comments -->
      <h4>Comments</h4>
      <div class="wpdiscuz_top_clearing"></div>
      <div id="comments" class="comments-area">
       <div id="respond" style="width: 0;height: 0;clear: both;margin: 0;padding: 0;"></div>
       <div id="wpdcom" class="wpdiscuz_unauth wpd-default wpd-layout-1 wpd-comments-open">
        <div class="wc_social_plugin_wrapper"></div>
        <div class="wpd-form-wrap">
         <div class="wpd-form-head">
          <div class="wpd-auth">
           <div class="wpd-login"></div>
          </div>
         </div>
         <div class="wpd-form wpd-form-wrapper wpd-main-form-wrapper" id="wpd-main-form-wrapper-0_0"></div>
         <div id="wpdiscuz_hidden_secondary_form" style="display: none;">
          <div class="wpd-form wpd-form-wrapper wpd-secondary-form-wrapper" id="wpd-secondary-form-wrapper-wpdiscuzuniqueid" style="display: none;">
           <div class="wpd-secondary-forms-social-content"></div>
           <div class="clearfix"></div>
          </div>
         </div>
        </div>
        <div id="wpd-threads" class="wpd-thread-wrapper">
         <div class="wpd-thread-head">
          <div class="wpd-thread-info " data-comments-count="0"> <span class="wpdtc" title="0">0</span> Comments
          </div>
          <div class="wpd-space"></div>
          <div class="wpd-thread-filter"></div>
         </div>
         <div class="wpd-comment-info-bar">
          <div class="wpd-current-view">
           <i class="fas fa-quote-left"></i> Inline Feedbacks
          </div>
          <div class="wpd-filter-view-all">
           View all comments
          </div>
         </div>
         <div class="wpd-thread-list">
          <div class="wpdiscuz-comment-pagination"></div>
         </div>
        </div>
       </div>
      </div>
      <div id="wpdiscuz-loading-bar" class="wpdiscuz-loading-bar-unauth"></div>
      <div id="wpdiscuz-comment-message" class="wpdiscuz-comment-message-unauth"></div>
     </article>
    </main> <!-- right -->
    <div id="sidebar-right" class="d-none d-xl-block col-xl-3">
     <div class="ads-container-height1080">
      <div class="ads-container-sticky">
       <div class="ads-container">
        <div align="center" data-freestar-ad="__300x600" id="mkyong_rail_right_1">  
        </div>
       </div>
      </div>
     </div>
     <div class="ads-container-sticky">
      <div class="ads-container">
       <div align="center" data-freestar-ad="__300x600" id="mkyong_rail_right_2">  
       </div>
      </div>
     </div>
    </div>
   </div> <!--/.row -->
  </div> <!--/.container-fluid -->  <!-- Dynamic page generated in 0.089 seconds. --><!-- Cached page generated by WP-Super-Cache on 2021-09-29 17:17:40 --><!-- super cache -->
 </body>
</html>